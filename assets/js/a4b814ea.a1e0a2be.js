"use strict";(self.webpackChunkmarkdown_website=self.webpackChunkmarkdown_website||[]).push([[6255],{5058:(n,e,o)=>{o.r(e),o.d(e,{assets:()=>p,contentTitle:()=>t,default:()=>m,frontMatter:()=>s,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"clients/Ecasa/comer/238849/C - Incongruencias Tipo de pago y grup","title":"C - Incongruencias Tipo de pago y grupo de pago","description":"Polisses amb incongruencies","source":"@site/docs/clients/Ecasa/comer/238849/C - Incongruencias Tipo de pago y grup.md","sourceDirName":"clients/Ecasa/comer/238849","slug":"/clients/Ecasa/comer/238849/C - Incongruencias Tipo de pago y grup","permalink":"/docs/clients/Ecasa/comer/238849/C - Incongruencias Tipo de pago y grup","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"clientsSidebar","previous":{"title":"[243835] Error en varias facturas - EBRO","permalink":"/docs/clients/Ebroenergia/243835/"},"next":{"title":"[240362] Factura parada","permalink":"/docs/clients/Ecasa/comer/240362/"}}');var i=o(4848),c=o(8453);const s={},t="C - Incongruencias Tipo de pago y grupo de pago",p={},d=[{value:"Polisses amb incongruencies",id:"polisses-amb-incongruencies",level:2},{value:"SQL per obtenir els que s&#39;han de modificar",id:"sql-per-obtenir-els-que-shan-de-modificar",level:2}];function r(n){const e={code:"code",h1:"h1",h2:"h2",header:"header",pre:"pre",...(0,c.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"c---incongruencias-tipo-de-pago-y-grupo-de-pago",children:"C - Incongruencias Tipo de pago y grupo de pago"})}),"\n",(0,i.jsx)(e.h2,{id:"polisses-amb-incongruencies",children:"Polisses amb incongruencies"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"SELECT\n    pol.payment_mode_id, pol.tipo_pago,\n    modcon.payment_mode_id, modcon.tipo_pago\nFROM giscedata_polissa pol\nLEFT JOIN giscedata_polissa_modcontractual modcon ON modcon.id = pol.modcontractual_activa\nWHERE pol.id IN (2873, 5358, 9187, 10676, 14293, 14774, 15459, 15508, 23467, 23996, 27367, 33074, 34864, 39429, 41097, 41620, 43133, 43921, 44474, 53687, 59874, 60445, 60506, 60797, 62617, 63582, 63582, 65029, 67086, 70948, 71451, 71451, 71452, 71453, 71454, 72394, 74746, 74765, 77083, 79268, 85736, 85736, 85867, 86069, 86576, 86620, 87435, 88296, 88523, 88984, 89006, 89006, 89008, 89010, 89011, 89012, 89013, 89014, 89015, 89018, 89019, 89020, 89021, 89022, 89023, 89025, 89026, 89027, 89028, 89029, 89031, 89033, 89034, 89035, 89036, 89037, 89038, 89040, 89041, 89042, 89043, 89044, 89046, 89049, 89052, 89054, 89056, 89057, 89058, 89059, 89060, 89061, 89062, 89063, 89064, 89065, 89067, 89067, 89071, 89072, 89073, 89074, 89078, 89079, 89080, 89081, 89082, 89084, 89086, 89087, 89088, 89089, 89091, 89092, 89093, 89095, 89096, 89097, 89100, 89101, 89167);\n"})}),"\n",(0,i.jsx)(e.h2,{id:"sql-per-obtenir-els-que-shan-de-modificar",children:"SQL per obtenir els que s'han de modificar"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"SELECT pol.id\nFROM giscedata_polissa pol\nLEFT JOIN giscedata_polissa_modcontractual modcon ON modcon.id = pol.modcontractual_activa\nLEFT JOIN payment_mode pm on pm.id = pol.payment_mode_id\nWHERE pm.type <> pol.tipo_pago;\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"BEGIN;\n-- Modcons\nUPDATE giscedata_polissa_modcontractual mod\nSET tipo_pago = (\n    SELECT\n        type\n    FROM payment_mode pm\n    WHERE\n        pm.id = mod.payment_mode_id\n    )\nWHERE mod.id in (\n    SELECT\n        modcon.id\n    FROM giscedata_polissa_modcontractual modcon\n    LEFT JOIN payment_mode pm ON pm.id = modcon.payment_mode_id\n    WHERE\n        pm.type <> modcon.tipo_pago);\n-- Polisses\nUPDATE giscedata_polissa pol\nSET tipo_pago = (\n    SELECT\n        type\n    FROM payment_mode pm\n    WHERE\n        pm.id = pol.payment_mode_id\n    )\nWHERE pol.id in (\n    SELECT\n        pol.id\n    FROM giscedata_polissa pol\n    LEFT JOIN payment_mode pm ON pm.id = pol.payment_mode_id\n    WHERE\n        pm.type <> pol.tipo_pago);\n-- Factures\nUPDATE account_invoice inv\nSET payment_type = (\n    SELECT\n        type\n    FROM payment_mode pm\n    WHERE\n        pm.id = (select payment_mode_id from giscedata_facturacio_factura where invoice_id = inv.id)\n    )\nWHERE inv.id in (\n    SELECT\n        inv.id\n    FROM giscedata_facturacio_factura fac\n    LEFT JOIN account_invoice inv ON inv.id = fac.invoice_id\n    LEFT JOIN payment_mode pm ON pm.id = fac.payment_mode_id\n    WHERE\n        pm.type <> inv.payment_type);\n"})})]})}function m(n={}){const{wrapper:e}={...(0,c.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(r,{...n})}):r(n)}},8453:(n,e,o)=>{o.d(e,{R:()=>s,x:()=>t});var a=o(6540);const i={},c=a.createContext(i);function s(n){const e=a.useContext(c);return a.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:s(n.components),a.createElement(c.Provider,{value:e},n.children)}}}]);