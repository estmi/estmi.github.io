"use strict";(self.webpackChunkmarkdown_website=self.webpackChunkmarkdown_website||[]).push([[940],{7047:(e,r,a)=>{a.r(r),a.d(r,{assets:()=>d,contentTitle:()=>l,default:()=>u,frontMatter:()=>t,metadata:()=>n,toc:()=>o});const n=JSON.parse('{"id":"Gisce/procediments/translate_module","title":"Traduccio d\'un modul","description":"- Traduir .py","source":"@site/docs/Gisce/procediments/translate_module.md","sourceDirName":"Gisce/procediments","slug":"/Gisce/procediments/translate_module","permalink":"/docs/Gisce/procediments/translate_module","draft":false,"unlisted":false,"editUrl":"https://github.com/estmi/MarkdownServer/tree/master/docs/Gisce/procediments/translate_module.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Revisar Dades Mako","permalink":"/docs/Gisce/procediments/revisar_dades_mako"},"next":{"title":"Arrancar port a part","permalink":"/docs/Gisce/varis/Arrancar port a part"}}');var s=a(4848),i=a(8453);const t={},l="Traduccio d'un modul",d={},o=[{value:"Traduir .py",id:"traduir-py",level:2},{value:"Traduir XML",id:"traduir-xml",level:2},{value:"Migration",id:"migration",level:2},{value:"Get POT",id:"get-pot",level:2},{value:"Transifex",id:"transifex",level:2},{value:"GET PO",id:"get-po",level:2},{value:"Update Migration",id:"update-migration",level:2},{value:"Run scripts",id:"run-scripts",level:2},{value:"Arreglar tests",id:"arreglar-tests",level:2}];function c(e){const r={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.header,{children:(0,s.jsx)(r.h1,{id:"traduccio-dun-modul",children:"Traduccio d'un modul"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"#traduir-py",children:"Traduir .py"})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"#traduir-xml",children:"Traduir XML"})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"#migration",children:"Migration"})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"#get-pot",children:"Get POT"})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"#transifex",children:"Transifex"})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"#get-po",children:"GET PO"})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"#update-migration",children:"Update Migration"})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"#run-scripts",children:"Run scripts"})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"#arreglar-tests",children:"Arreglar tests"})}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"traduir-py",children:"Traduir .py"}),"\n",(0,s.jsxs)(r.p,{children:["Primerament traduirem tots els arxius python del m\xf2dul.",(0,s.jsx)(r.br,{}),"\n",(0,s.jsx)(r.strong,{children:"Tenir en compte no modificar les keys dels strings, ja que sin\xf3 el format no podr\xe0 fer l'associaci\xf3"})]}),"\n",(0,s.jsx)(r.h2,{id:"traduir-xml",children:"Traduir XML"}),"\n",(0,s.jsxs)(r.p,{children:["En aquest punt traduirem tots els xml, tot el que sigui text.",(0,s.jsx)(r.br,{}),"\n",(0,s.jsx)(r.strong,{children:"Tenir en compte que les vistes heredades busquen per aquests noms i poden petar."}),(0,s.jsx)(r.br,{}),"\n",(0,s.jsx)(r.strong,{children:"Tenir en compte no canviar els noms dels camps, ja que sin\xf3 no trobar\xe0 el field en el model"})]}),"\n",(0,s.jsx)(r.h2,{id:"migration",children:"Migration"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"/docs/Gisce/migrations/language_migration#language-migration",children:"Crear migracio PR idiomes"})}),"\n",(0,s.jsx)(r.h2,{id:"get-pot",children:"Get POT"}),"\n",(0,s.jsxs)(r.p,{children:["Per obtenir l'idioma original, farem el seguent substituint ",(0,s.jsx)(r.code,{children:"$module_name$"})," pel nom del modul a traduir:"]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["Arrancar un destral amb els parametres: ",(0,s.jsx)(r.code,{children:"--no-dropdb -m $module_name$ -t OOBaseTests.test_translate_modules"})]}),"\n",(0,s.jsx)(r.li,{children:"Arrancar openerp-server amb la base de dades recent instalada i obrir webclient"}),"\n",(0,s.jsxs)(r.li,{children:["Instal\xb7lar idiomes, tant l'original (",(0,s.jsx)(r.code,{children:"$base_lang$"}),") com el que s'ha de traduir (",(0,s.jsx)(r.code,{children:"$translated_lang$"}),"). ",(0,s.jsx)(r.a,{href:"/docs/Gisce/procediments/install_language",children:"Instal\xb7lar Idiomes"})]}),"\n",(0,s.jsxs)(r.li,{children:["Exportar ",(0,s.jsx)(r.code,{children:".pot"})," amb l'",(0,s.jsx)(r.a,{href:"/docs/Gisce/procediments/export_language#us-en-cas-dexportacio-pot-per-a-transifex",children:"Assistent d'exportar idiomes"})]}),"\n"]}),"\n",(0,s.jsxs)(r.p,{children:["Tambe es pot consultar l'",(0,s.jsx)(r.a,{href:"https://rfc.gisce.net/t/traducciones-procedimiento-para-traducir-un-modulo/392",children:"rfc transifex"})]}),"\n",(0,s.jsx)(r.h2,{id:"transifex",children:"Transifex"}),"\n",(0,s.jsx)(r.p,{children:"Per a poder fer la traducci\xf3 utilitzarem un servei anomenat Transifex i aquests son els passos:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:["Situarem el ",(0,s.jsx)(r.code,{children:".pot"})," descarregat a la carpeta ",(0,s.jsx)(r.code,{children:"$module_name$/i18n"})," del modul indicat",(0,s.jsx)(r.br,{}),"\n",(0,s.jsx)(r.img,{src:"/gisce_data/procediments/translate_module/pycharm_pot_file_location.png",alt:"pycharm_pot_file_location"})]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:["Un cop ubicat al seu lloc (podria ser que hagu\xe9ssim de crear la carpeta ",(0,s.jsx)(r.code,{children:"i18n"}),") anirem a l'arxiu ",(0,s.jsx)(r.code,{children:"erp/.tx/config"})," i alla buscarem el nostre m\xf2dul, per exemple:"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-txt",children:"[erp.giscedata_facturacio_comparador]\nsource_file = addons/gisce/GISCEMaster/giscedata_facturacio_comparador/i18n/giscedata_facturacio_comparador.pot\ntype = PO\nfile_filter = addons/gisce/GISCEMaster/giscedata_facturacio_comparador/i18n/<lang>.po\nsource_lang = es_ES\n"})}),"\n",(0,s.jsx)(r.p,{children:"Aquest bloc esta composat per la seguent estructura:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-txt",children:"[$repo_name$.$module_name$]\nsource_file = $ubicacio_pot$\ntype = PO # Sempre Igual\nfile_filter = $ruta_carpeta_i18n_mes_`<lang>.po`$\nsource_lang = $idioma_base_utilitzat_per_programar$\n"})}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:["Ara utilitzarem una comanda per a poder pujar el ",(0,s.jsx)(r.code,{children:".pot"})," al transifex: ",(0,s.jsx)(r.code,{children:"tx push -r erp.$module_name$ -s"}),(0,s.jsx)(r.br,{}),"\n",(0,s.jsx)(r.img,{src:"/gisce_data/procediments/translate_module/bash_tx_push_execution.png",alt:"bash_tx_push_execution"})]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:["Un cop pujat al transifex, entrarem a la web ",(0,s.jsx)(r.a,{href:"https://trad.gisce.net",children:"https://trad.gisce.net"}),", farem login i anirem a resources. Alla veurem tots els moduls traduits, el que farem sera obrir el nostre modul i obrir la traduccio a fer, per exemple el catala en aquest cas. I alla ens surtiran tots els termes per a poder traduirlos.",(0,s.jsx)(r.br,{}),"\n",(0,s.jsx)(r.strong,{children:"Important marcar el check de reviewed!!"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"get-po",children:"GET PO"}),"\n",(0,s.jsxs)(r.p,{children:["Per poder obtenir el ",(0,s.jsx)(r.code,{children:".po"}),", arxiu que conte tots els termes traduits, entrarem dintre del modul, a l'idioma que volguem descarregar i donarem a la opcio de ",(0,s.jsx)(r.code,{children:"Download for use"}),":"]}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.img,{src:"/gisce_data/procediments/translate_module/transifex_module_view.png",alt:"transifex_module_view"}),"\n",(0,s.jsx)(r.img,{src:"/gisce_data/procediments/translate_module/transifex_module_view_language.png",alt:"transifex_module_view_language"})]}),"\n",(0,s.jsxs)(r.p,{children:["Aixo ens descarregara un arxiu ",(0,s.jsx)(r.code,{children:".po"})," el qual renombrarem a ",(0,s.jsx)(r.code,{children:"ca_ES.po"}),", aquest nom dependra de l'idioma de traduccio i el posarem a la carpeta ",(0,s.jsx)(r.code,{children:"i18n"})," del modul:"]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"/gisce_data/procediments/translate_module/pycharm_po_file_location.png",alt:"pycharm_po_file_location"})}),"\n",(0,s.jsx)(r.h2,{id:"update-migration",children:"Update Migration"}),"\n",(0,s.jsxs)(r.p,{children:["Ara que ja tenim el ",(0,s.jsx)(r.code,{children:".po"})," creat, necessitem carregar-lo, i aixo ho farem amb la migracio, que hi afegirem el seguent al final del metode up:"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-python",children:"lang = 'ca_ES'\ntrans_load(cursor, '{}/{}/i18n/{}.po'.format(config['addons_path'], module_name, lang), lang)\n"})}),"\n",(0,s.jsx)(r.p,{children:"Per a executar aixo, necessitarem import el seguent:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-python",children:"from tools import config\nfrom tools.translate import trans_load\n"})}),"\n",(0,s.jsx)(r.h2,{id:"run-scripts",children:"Run scripts"}),"\n",(0,s.jsx)(r.p,{children:"Ara nomes falta provar-ho en local i despres a PRE. Son PRs lentes de aplicar ja que hi pot haver varis conflictes."}),"\n",(0,s.jsx)(r.h2,{id:"arreglar-tests",children:"Arreglar tests"}),"\n",(0,s.jsx)(r.p,{children:"Es molt possible si es toquen missatges de errors que 'petin' els tests fets en aquest modul, caldra revisar-ho."})]})}function u(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,r,a)=>{a.d(r,{R:()=>t,x:()=>l});var n=a(6540);const s={},i=n.createContext(s);function t(e){const r=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),n.createElement(i.Provider,{value:r},e.children)}}}]);