from erppeek import Client
c = Client('http://localhost:12000', 'comer_gasiluz', 'gisce', 'atrallum.gas')

contract_numbers = [
    # A02638534
    '2024026810',
    '2024026811',
    '2024026814',
    '2024026818',
    '2024026821',
    '2024026823',
    '2024026824',
    '2024026868',
    '2024026869',
    '2024026870',
    '2024026871',
    '2024026872',
    '2024026873',
    '2024026874',
    '2024026875',
    '2024026876',
    '2024026877',
    '2024026878',
    '2024026879',
    '2024026880',
    '2024026881',
    '2024026882',
    '2024026883',
    '2024026884',
    '2024026885',
    '2024026886',
    '2024026887',
    '2024026888',
    '2024026889',
    '2024026890',
    '2024026891',
    '2024026892',
    '2024026893',
    '2024026894',
    '2024026895',
    '2024026897',
    '2024026899',
    '2024026900',
    '2024026901',
    '2024026902',
    # A02638534
    '2024028004',
    # A99317810
    '2024028005',
    # A84790716
    '2024026794',
    '2024026795',
    # B87254488
    '2024026798',
    # B87876629
    '2024026946',
    # B87924320
    '2024026852',
    '2024026855',
    # B87126413
    '2024026812',
    '2024026813',
    '2024026815',
    '2024026816',
    '2024026817',
    '2024026819',
    '2024026820',
    '2024026822',
    '2024026825',
    '2024026842',
    '2024026844',
    '2024026845',
    '2024026846',
    '2024026847',
    '2024026848',
    '2024026849',
    '2024026850',
    '2024026903',
    '2024026841',
    # B88134770
    '2024026800',
    # B88278718
    '2024026857',
    '2024026858',
    '2024026859',
    '2024026860',
    '2024026862',
    '2024026863',
    '2024026865',
    '2024026866',
    '2024026867',
    '2024026856',
    '2024026861',
    '2024026864',
    '2024026945',
]

vals = {'enviament': 'postal', 'zona_carta_id': 2}
pol_obj = c.model('giscedata.polissa')
pol_ids = pol_obj.search([('name', 'in', contract_numbers)])
pol_names = pol_obj.read(pol_ids, ['enviament', 'zona_carta_id','name'])
idx = 1
for pol in pol_names:
    pol_obj.write(pol['id'], vals)
    print('{}({}): envio: [{}] zona: [{}]'.format(pol['id'],pol['name'],pol['enviament'], pol['zona_carta_id']))
    pol2 = pol_obj.read(pol['id'], ['enviament', 'zona_carta_id','name'])
    print('{}({}): envio: [{}] zona: [{}]'.format(pol2['id'],pol2['name'],pol2['enviament'], pol2['zona_carta_id']))