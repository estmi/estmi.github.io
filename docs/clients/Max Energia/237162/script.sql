-- SELECT
select pol.zona_carta_id, pol.enviament, modcon.enviament, count(*) from 
giscedata_polissa_modcontractual modcon
left join giscedata_polissa pol on modcon.polissa_id = pol.id
left join giscedata_cups_ps cups on cups.id = pol.cups where cups.name in ('ES0031500103073001ZA0F','ES0031500105234003SV0F','ES0031500112426010AQ0F','ES0031500123510019KA0F','ES0031500129150006BE0F','ES0031500142572001CE0F','ES0031500225130001GM0F','ES0031500279731001SV0F','ES0031500508694001EH0F','ES0031500542674001DW0F','ES0031500573957001BN0F','ES0031500575463001PH0F','ES0031500575463002PL0F','ES0031500601505012AA0F','ES0031500608660001ZZ0F','ES0031500608661001NW0F','ES0031500608661003NG0F','ES0031500626551001RG0F','ES0031500633251001XN0F','ES0031500633253001MB0F','ES0031500633253002MN0F','ES0031500633256001CK0F','ES0031500633256002CE0F','ES0031500633256003KT0F','ES0031500638678001XR0F','ES0031500638678002XW0F','ES0031500647795001LP0F','ES0031500647795002LD0F','ES0031500651806001RS0F','ES0031500652172001KQ0F','ES0031500652174001QS0F','ES0031500652174002QQ0F','ES0031500654113002AR0F','ES0031500656205001VN0F','ES0031500662355001XL0F','ES0031500697564008AM0F','ES0031500706217002DP0F','ES0031500567417001NQ0F','ES0031500567411001GL0F','ES0031500567407001ZK0F','ES0031500567420001MA0F','ES0031500567412001WF0F','ES0031500567412002WP0F','ES0031500246335001MV0F','ES0031500279958002HP0F','ES0031500259381002CG0F','ES0031500259379002WM0F','ES0031500259381003CM0F','ES0031500259381038KV0F','ES0031500240144001TL0F','ES0031500591470001PF0F','ES0031500591469002XC0F','ES0031500238550001HB0F','ES0031500613014005YA0F','ES0031500622893001WQ0F','ES0031500622891001FV0F','ES0031500622892001MM0F','ES0031500622892008MN0F','ES0031500530187001BR0F','ES0031500696502007JY0F','ES0031500279722001SX0F','ES0031500279456001LM0F','ES0031500279733001XQ0F','ES0031500279705001NF0F','ES0031500576138003PQ0F','ES0031500576138001PZ0F','ES0031500587146008XZ0F','ES0031500578890003ZC0F','ES0031500578889001VF0F','ES0031500578890002ZL0F','ES0031500578890001ZH0F','ES0031500708118013TT0F','ES0031500659519001DB0F','ES0031500659520002FT0F','ES0031500659521001GX0F','ES0031500659524001LC0F','ES0031500659518001NT0F','ES0031500659520001YE0F','ES0031500659522001RK0F','ES0031500659517001ZN0F','ES0031500659516001VR0F','ES0031500659520003FR0F','ES0031500238862001JQ0F','ES0031500238862002JV0F','ES0031500526793004JE0F','ES0031500696562017TD0F','ES0031500696563010CJ0F','ES0031500696563009CN0F','ES0031500696562014TY0F','ES0031500696562013TM0F') and pol.state <> 'cancelada'
group by pol.zona_carta_id, pol.enviament, modcon.enviament;

-- SELECT
select pol.zona_carta_id, pol.enviament, count(*) from giscedata_polissa pol
left join giscedata_cups_ps cups on cups.id = pol.cups where cups.name in ('ES0031500103073001ZA0F','ES0031500105234003SV0F','ES0031500112426010AQ0F','ES0031500123510019KA0F','ES0031500129150006BE0F','ES0031500142572001CE0F','ES0031500225130001GM0F','ES0031500279731001SV0F','ES0031500508694001EH0F','ES0031500542674001DW0F','ES0031500573957001BN0F','ES0031500575463001PH0F','ES0031500575463002PL0F','ES0031500601505012AA0F','ES0031500608660001ZZ0F','ES0031500608661001NW0F','ES0031500608661003NG0F','ES0031500626551001RG0F','ES0031500633251001XN0F','ES0031500633253001MB0F','ES0031500633253002MN0F','ES0031500633256001CK0F','ES0031500633256002CE0F','ES0031500633256003KT0F','ES0031500638678001XR0F','ES0031500638678002XW0F','ES0031500647795001LP0F','ES0031500647795002LD0F','ES0031500651806001RS0F','ES0031500652172001KQ0F','ES0031500652174001QS0F','ES0031500652174002QQ0F','ES0031500654113002AR0F','ES0031500656205001VN0F','ES0031500662355001XL0F','ES0031500697564008AM0F','ES0031500706217002DP0F','ES0031500567417001NQ0F','ES0031500567411001GL0F','ES0031500567407001ZK0F','ES0031500567420001MA0F','ES0031500567412001WF0F','ES0031500567412002WP0F','ES0031500246335001MV0F','ES0031500279958002HP0F','ES0031500259381002CG0F','ES0031500259379002WM0F','ES0031500259381003CM0F','ES0031500259381038KV0F','ES0031500240144001TL0F','ES0031500591470001PF0F','ES0031500591469002XC0F','ES0031500238550001HB0F','ES0031500613014005YA0F','ES0031500622893001WQ0F','ES0031500622891001FV0F','ES0031500622892001MM0F','ES0031500622892008MN0F','ES0031500530187001BR0F','ES0031500696502007JY0F','ES0031500279722001SX0F','ES0031500279456001LM0F','ES0031500279733001XQ0F','ES0031500279705001NF0F','ES0031500576138003PQ0F','ES0031500576138001PZ0F','ES0031500587146008XZ0F','ES0031500578890003ZC0F','ES0031500578889001VF0F','ES0031500578890002ZL0F','ES0031500578890001ZH0F','ES0031500708118013TT0F','ES0031500659519001DB0F','ES0031500659520002FT0F','ES0031500659521001GX0F','ES0031500659524001LC0F','ES0031500659518001NT0F','ES0031500659520001YE0F','ES0031500659522001RK0F','ES0031500659517001ZN0F','ES0031500659516001VR0F','ES0031500659520003FR0F','ES0031500238862001JQ0F','ES0031500238862002JV0F','ES0031500526793004JE0F','ES0031500696562017TD0F','ES0031500696563010CJ0F','ES0031500696563009CN0F','ES0031500696562014TY0F','ES0031500696562013TM0F') and pol.state <> 'cancelada'
group by pol.zona_carta_id, pol.enviament;

-- UPDATE POLISSA
update giscedata_polissa
set enviament = 'postal', zona_carta_id = 2
where cups in (select id from giscedata_cups_ps where name in ('ES0031500103073001ZA0F','ES0031500105234003SV0F','ES0031500112426010AQ0F','ES0031500123510019KA0F','ES0031500129150006BE0F','ES0031500142572001CE0F','ES0031500225130001GM0F','ES0031500279731001SV0F','ES0031500508694001EH0F','ES0031500542674001DW0F','ES0031500573957001BN0F','ES0031500575463001PH0F','ES0031500575463002PL0F','ES0031500601505012AA0F','ES0031500608660001ZZ0F','ES0031500608661001NW0F','ES0031500608661003NG0F','ES0031500626551001RG0F','ES0031500633251001XN0F','ES0031500633253001MB0F','ES0031500633253002MN0F','ES0031500633256001CK0F','ES0031500633256002CE0F','ES0031500633256003KT0F','ES0031500638678001XR0F','ES0031500638678002XW0F','ES0031500647795001LP0F','ES0031500647795002LD0F','ES0031500651806001RS0F','ES0031500652172001KQ0F','ES0031500652174001QS0F','ES0031500652174002QQ0F','ES0031500654113002AR0F','ES0031500656205001VN0F','ES0031500662355001XL0F','ES0031500697564008AM0F','ES0031500706217002DP0F','ES0031500567417001NQ0F','ES0031500567411001GL0F','ES0031500567407001ZK0F','ES0031500567420001MA0F','ES0031500567412001WF0F','ES0031500567412002WP0F','ES0031500246335001MV0F','ES0031500279958002HP0F','ES0031500259381002CG0F','ES0031500259379002WM0F','ES0031500259381003CM0F','ES0031500259381038KV0F','ES0031500240144001TL0F','ES0031500591470001PF0F','ES0031500591469002XC0F','ES0031500238550001HB0F','ES0031500613014005YA0F','ES0031500622893001WQ0F','ES0031500622891001FV0F','ES0031500622892001MM0F','ES0031500622892008MN0F','ES0031500530187001BR0F','ES0031500696502007JY0F','ES0031500279722001SX0F','ES0031500279456001LM0F','ES0031500279733001XQ0F','ES0031500279705001NF0F','ES0031500576138003PQ0F','ES0031500576138001PZ0F','ES0031500587146008XZ0F','ES0031500578890003ZC0F','ES0031500578889001VF0F','ES0031500578890002ZL0F','ES0031500578890001ZH0F','ES0031500708118013TT0F','ES0031500659519001DB0F','ES0031500659520002FT0F','ES0031500659521001GX0F','ES0031500659524001LC0F','ES0031500659518001NT0F','ES0031500659520001YE0F','ES0031500659522001RK0F','ES0031500659517001ZN0F','ES0031500659516001VR0F','ES0031500659520003FR0F','ES0031500238862001JQ0F','ES0031500238862002JV0F','ES0031500526793004JE0F','ES0031500696562017TD0F','ES0031500696563010CJ0F','ES0031500696563009CN0F','ES0031500696562014TY0F','ES0031500696562013TM0F')) and state <> 'cancelada';

-- UPDATE MODCONS
update giscedata_polissa_modcontractual 
set enviament = 'postal'
where polissa_id in (select pol.id from giscedata_polissa pol
left join giscedata_cups_ps cups on cups.id = pol.cups where cups.name in ('ES0031500103073001ZA0F','ES0031500105234003SV0F','ES0031500112426010AQ0F','ES0031500123510019KA0F','ES0031500129150006BE0F','ES0031500142572001CE0F','ES0031500225130001GM0F','ES0031500279731001SV0F','ES0031500508694001EH0F','ES0031500542674001DW0F','ES0031500573957001BN0F','ES0031500575463001PH0F','ES0031500575463002PL0F','ES0031500601505012AA0F','ES0031500608660001ZZ0F','ES0031500608661001NW0F','ES0031500608661003NG0F','ES0031500626551001RG0F','ES0031500633251001XN0F','ES0031500633253001MB0F','ES0031500633253002MN0F','ES0031500633256001CK0F','ES0031500633256002CE0F','ES0031500633256003KT0F','ES0031500638678001XR0F','ES0031500638678002XW0F','ES0031500647795001LP0F','ES0031500647795002LD0F','ES0031500651806001RS0F','ES0031500652172001KQ0F','ES0031500652174001QS0F','ES0031500652174002QQ0F','ES0031500654113002AR0F','ES0031500656205001VN0F','ES0031500662355001XL0F','ES0031500697564008AM0F','ES0031500706217002DP0F','ES0031500567417001NQ0F','ES0031500567411001GL0F','ES0031500567407001ZK0F','ES0031500567420001MA0F','ES0031500567412001WF0F','ES0031500567412002WP0F','ES0031500246335001MV0F','ES0031500279958002HP0F','ES0031500259381002CG0F','ES0031500259379002WM0F','ES0031500259381003CM0F','ES0031500259381038KV0F','ES0031500240144001TL0F','ES0031500591470001PF0F','ES0031500591469002XC0F','ES0031500238550001HB0F','ES0031500613014005YA0F','ES0031500622893001WQ0F','ES0031500622891001FV0F','ES0031500622892001MM0F','ES0031500622892008MN0F','ES0031500530187001BR0F','ES0031500696502007JY0F','ES0031500279722001SX0F','ES0031500279456001LM0F','ES0031500279733001XQ0F','ES0031500279705001NF0F','ES0031500576138003PQ0F','ES0031500576138001PZ0F','ES0031500587146008XZ0F','ES0031500578890003ZC0F','ES0031500578889001VF0F','ES0031500578890002ZL0F','ES0031500578890001ZH0F','ES0031500708118013TT0F','ES0031500659519001DB0F','ES0031500659520002FT0F','ES0031500659521001GX0F','ES0031500659524001LC0F','ES0031500659518001NT0F','ES0031500659520001YE0F','ES0031500659522001RK0F','ES0031500659517001ZN0F','ES0031500659516001VR0F','ES0031500659520003FR0F','ES0031500238862001JQ0F','ES0031500238862002JV0F','ES0031500526793004JE0F','ES0031500696562017TD0F','ES0031500696563010CJ0F','ES0031500696563009CN0F','ES0031500696562014TY0F','ES0031500696562013TM0F') and pol.state <> 'cancelada');