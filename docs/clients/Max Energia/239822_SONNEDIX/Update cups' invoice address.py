cups_list = ['ES0021000012382688HZ','ES0021000015359259JV','ES0021000015490929BN','ES0021000015565969PA','ES0021000015582641CT','ES0021000015582651CX','ES0021000015587426KR','ES0021000015782386XJ','ES0021000015783989BY','ES0021000015795227QC','ES0021000015809462ZH','ES0021000015809482SS','ES0021000015809489SE','ES0021000015812047NG','ES0021000015813261HE','ES0021000015814966RW','ES0021000015843611GN','ES0021000015843635MJ','ES0021000015843635MJ','ES0021000015848978FC','ES0021000015848992PB','ES0021000015895380RP','ES0021000015989127YF','ES0021000016085909MM','ES0021000016768495NC','ES0021000017321900SE','ES0021000017433924XJ','ES0021000017744761RM','ES0021000017903501WE','ES0021000018196254NP','ES0021000018204553MG','ES0021000018590179GN','ES0021000018605969RR','ES0021000019089777ZG','ES0021000019112706EW','ES0021000039309354CM','ES0022000008475229NS','ES0022000008677895SM','ES0022000008677896SY','ES0022000008677897SF','ES0022000008677898SP','ES0022000008677900SX','ES0022000008677901SB','ES0022000008686068WJ','ES0022000008701201QN','ES0022000008701202QJ','ES0022000008701203QZ','ES0022000008701204QS','ES0022000008701205QQ','ES0022000008701206QV','ES0022000008701207QH','ES0022000008701208QL','ES0022000008701209QC','ES0022000008701210QK','ES0022000008701211QE','ES0022000008701212VT','ES0022000008701438AL','ES0022000008701439AC','ES0022000008701440AK','ES0022000008701441AE','ES0022000008701442GT','ES0022000008701443GR','ES0022000008701444GW','ES0022000008701445GA','ES0022000008701446GG','ES0022000008701447GM','ES0022000008701448GY','ES0022000008701449GF','ES0022000008703618YZ','ES0022000008703618YZ','ES0022000008703619YS','ES0022000008703620YQ','ES0022000008703622YH','ES0022000008703623YL','ES0022000008712397CF','ES0022000008712507WW','ES0022000008832887ST','ES0022000008946627SM','ES0031000000501124HN','ES0031000000501125HJ','ES0031000000501126HZ','ES0031000000501127HS','ES0031000000501128HQ','ES0031000000501129HV','ES0031000000501696CD','ES0031000000501973DX','ES0031000000501976DJ','ES0031104852091001TH','ES0031104852102001LR','ES0031104857374001HX','ES0031105156566001AY','ES0031105454315001SE','ES0031300680267001KN','ES0031408481369001XF','ES0031408482624001LN','ES0031408602683001BR','ES0304000015006800HD','ES0304000020004350EG']

from erppeek import Client
c = Client('http://localhost:18069', 'comer_gasiluz', 'gisce', 'atrallum.gas')

cups_list = ['ES0021000012382688HZ','ES0021000015359259JV','ES0021000015490929BN','ES0021000015565969PA','ES0021000015582641CT','ES0021000015582651CX','ES0021000015587426KR','ES0021000015782386XJ','ES0021000015783989BY','ES0021000015795227QC','ES0021000015809462ZH','ES0021000015809482SS','ES0021000015809489SE','ES0021000015812047NG','ES0021000015813261HE','ES0021000015814966RW','ES0021000015843611GN','ES0021000015843635MJ','ES0021000015843635MJ','ES0021000015848978FC','ES0021000015848992PB','ES0021000015895380RP','ES0021000015989127YF','ES0021000016085909MM','ES0021000016768495NC','ES0021000017321900SE','ES0021000017433924XJ','ES0021000017744761RM','ES0021000017903501WE','ES0021000018196254NP','ES0021000018204553MG0P','ES0021000018590179GN','ES0021000018605969RR','ES0021000019089777ZG','ES0021000019112706EW','ES0021000039309354CM','ES0022000008475229NS','ES0022000008677895SM','ES0022000008677896SY','ES0022000008677897SF','ES0022000008677898SP','ES0022000008677900SX','ES0022000008677901SB','ES0022000008686068WJ1p','ES0022000008701201QN','ES0022000008701202QJ','ES0022000008701203QZ','ES0022000008701204QS','ES0022000008701205QQ','ES0022000008701206QV','ES0022000008701207QH','ES0022000008701208QL','ES0022000008701209QC','ES0022000008701210QK','ES0022000008701211QE','ES0022000008701212VT','ES0022000008701438AL','ES0022000008701439AC','ES0022000008701440AK','ES0022000008701441AE','ES0022000008701442GT','ES0022000008701443GR','ES0022000008701444GW','ES0022000008701445GA','ES0022000008701446GG','ES0022000008701447GM','ES0022000008701448GY','ES0022000008701449GF','ES0022000008703618YZ','ES0022000008703618YZ1F','ES0022000008703619YS1F','ES0022000008703620YQ1F','ES0022000008703622YH1F','ES0022000008703623YL1F','ES0022000008712397CF','ES0022000008712507WW1P','ES0022000008832887ST1P','ES0022000008946627SM','ES0031000000501124HN','ES0031000000501125HJ','ES0031000000501126HZ','ES0031000000501127HS','ES0031000000501128HQ','ES0031000000501129HV','ES0031000000501696CD','ES0031000000501973DX','ES0031000000501976DJ','ES0031104852091001TH0F','ES0031104852102001LROF','ES0031104857374001HX0F','ES0031105156566001AY','ES0031105454315001SE','ES0031300680267001KN','ES0031408481369001XF0F','ES0031408482624001LN0F','ES0031408602683001BR0F','ES0304000015006800HD','ES0304000020004350EG']

cups_data = []
found_cups = []
not_found_cups = []
for cups in cups_list:
    pol_ids = c.GiscedataPolissa.search([('cups','ilike',cups)], context={'active_test':False})
    if len(pol_ids)> 0:
        pol_id = pol_ids[0]
        pol_read = c.GiscedataPolissa.read(pol_id, ['name','direccio_notificacio'])
        addr_read = c.ResPartnerAddress.read(pol_read['direccio_notificacio'][0], ['email'])
        pol_name = pol_read['name']
        cups_data.append({'id':pol_id,'cups':cups,'name':pol_name,'email':addr_read['email'],'addr_id':addr_read['id'],'email2':'madridassetmanagement@sonnedix.com'})
        found_cups.append(cups)

print('ids:{} cups:{}'.format(len(cups_data), len(cups_list)))

raw_input()

print('CUPS: N Poliza (id Poliza) [(id direccion afectada): email] -> [email destino]')
for pol in cups_data:
    print('{cups}: {name} ({id}) [({addr_id}): {email}] -> [{email2}]'.format(**pol))
    c.ResPartnerAddress.write(pol['addr_id'], {'email': pol['email2']})

for cups in cups_list:
    if cups not in found_cups:
        not_found_cups.append(cups)